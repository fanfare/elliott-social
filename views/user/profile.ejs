<% include ../partials/header %>

                
<main>


    <% if(currentUser){ if(currentUser.username == profile.username){ %>
        <div id="tabs">
            <a id="preview-tab" class="current-tab">Profile</a>
            <a id="edit-tab">Edit</a>
            <a id="favorites-tab">Bookmarks</a>
        </div>

        <div id="edit-tab-content">
            <section>
                <form action="/<%= profile.username %>?_method=PUT" method="POST">
                    <div class="form-group">
                        <label class="editProfileLabel" for="description">Text</label><br />
                        <textarea class="form-control" name="description"><%= profile.user.description %></textarea>
                    </div>
                    <div class="form-group">
                        <label class="editProfileLabel" for="description">Music</label><br />
                        <input class="form-control" name="song1" value="<%= profile.user.songs.song1 %>" type="url" placeholder="url"><br />
                        <input class="form-control" name="song2" value="<%= profile.user.songs.song2 %>" type="url" placeholder="url"><br />
                        <input class="form-control" name="song3" value="<%= profile.user.songs.song3 %>" type="url" placeholder="url"><br />
                        <input class="form-control" name="song4" value="<%= profile.user.songs.song4 %>" type="url" placeholder="url"><br />
                        <input class="form-control" name="song5" value="<%= profile.user.songs.song5 %>" type="url" placeholder="url"><br />
                    </div>
                    <div class="form-group">
                        <label class="editProfileLabel" for="description">Books</label><br />
                        <input class="form-control" name="book1" value="<%= profile.user.books.book1 %>" type="text" placeholder="title, author"><br />
                        <input class="form-control" name="book2" value="<%= profile.user.books.book2 %>" type="text" placeholder="title, author"><br />
                        <input class="form-control" name="book3" value="<%= profile.user.books.book3 %>" type="text" placeholder="title, author"><br />
                        <input class="form-control" name="book4" value="<%= profile.user.books.book4 %>" type="text" placeholder="title, author"><br />
                        <input class="form-control" name="book5" value="<%= profile.user.books.book5 %>" type="text" placeholder="title, author"><br />
                    </div>
                    <div class="form-group">
                        <label class="editProfileLabel" for="description">Links</label><br />
                        <input class="form-control" name="link1" value="<%= profile.user.links.link1 %>" type="url" placeholder="url"><br />
                        <input class="form-control" name="link2" value="<%= profile.user.links.link2 %>" type="url" placeholder="url"><br />
                        <input class="form-control" name="link3" value="<%= profile.user.links.link3 %>" type="url" placeholder="url"><br />
                        <input class="form-control" name="link4" value="<%= profile.user.links.link4 %>" type="url" placeholder="url"><br />
                        <input class="form-control" name="link5" value="<%= profile.user.links.link5 %>" type="url" placeholder="url"><br />
                    </div>
                    <div class="form-group">
                        <label class="editProfileLabel" for="location">Location</label>
                        <input class="form-control" name="location" value="<%= profile.user.location %>" type="text" placeholder="Location" required>
                    </div>
                    <div class="form-group">
                        <label class="editWebsiteLabel" for="website">Website</label>
                        <input class="form-control" name="website" value="<%= profile.user.website %>" type="url">
                    </div>
                    <div class="form-group">
                        <label class="editUsernameLabel" for="username">Username</label>
                        <input class="form-control" name="username" value="<%= profile.username %>" type="text" required>
                    </div>
                    <div class="form-group">
                        <label class="editColorLabel" for="color">Color</label><br />
                        <input class="form-control" name="color" value="<%= (profile.user.color == null) ? '#32a852' : profile.user.color  %>" type="color" placeholder="#32a852" required>
                    </div>
                    <div class="form-group">
                        <label class="editShapeLabel" for="shape">Shape</label>
                        <select name="shape">
                            <option <% if(profile.user.shape == '') { %>selected<% } %> value=""></option>
                            <option <% if(profile.user.shape == 'flower') { %>selected<% } %> value="flower">flower</option>
                            <option <% if(profile.user.shape == 'heart') { %>selected<% } %> value="heart">heart</option>
                            <option <% if(profile.user.shape == 'leaf') { %>selected<% } %> value="leaf">leaf</option>
                            <option <% if(profile.user.shape == 'mushroom') { %>selected<% } %> value="mushroom">mushroom</option>
                            <option <% if(profile.user.shape == 'pebble') { %>selected<% } %> value="pebble">pebble</option>
                            <option <% if(profile.user.shape == 'star') { %>selected<% } %> value="star">star</option>
                        </select>
                    </div>
                    <div class="form-group">
                    <button class="regular-button">Save</button>
                </form>
            </section>
        </div>

        <div id="favorites-tab-content">
            <section>
                <h3>Favorites</h3>
        
                <% if(friends.length > 0) { %>
                <ol>
                    <% friends.forEach(function(friend) { %>
                        <% if(friend != null) { %>
                            <li>
                            <a href="<%= friend.username %>" class="box small" style="background-color: <%= friend.user.color %> !important;"></a> <%= friend.username %>
                            <form class="remove-friend" action='<%= currentUser.username %>/remove-friend/<%= friend._id %>?_method=DELETE' method='POST'>
                                <button class="tiny-button">release</button>
                            </form>
                            </li>
                        <% } %>
                    <% }) %>
                </ol>
                <% } %>
            </section>
        </div>
        
    <% } } %>

    <% if(currentUser){ if(currentUser.username == profile.username){ %>
    <div id="preview-tab-content">
    <% } } else { %>
    <div>
    <% } %>
        <span class="box large" style="background-color: <%= profile.user.color %> !important;"></span> <% if(profile.user.shape){ %><span class="shape <%= profile.user.shape %>"></span><% } %>
        <h2>
            <%= profile.username %>
        </h2>

        <p>
            <% if(profile.user.website){ %><a href="<%= profile.user.website %>"><%= profile.user.website %></a>, <% } %><%= profile.user.location %>
        </p>

        <% if(currentUser){ if(currentUser.username != profile.username){ %>
            <p>
                <form class="add-friend" action="/<%= profile.username %>/friend?_method=PUT" method="POST">
                    <button class="tiny-button">+</button>
                </form>
            </p>
        <% }} %>

    
        <% if(profile.user.description) { %>
            <section style="white-space: pre-wrap;"><%= profile.user.description %></section>
        <% } %>
    
        <% if(profile.user.songs.song1) { %>
            <section>
                <h3>Music</h3>
                <ul>
                    <% if(profile.user.songs.song1) { %><li><a href="<%= profile.user.songs.song1 %>"><%= profile.user.songs.song1 %></a></li><% } %>
                    <% if(profile.user.songs.song2) { %><li><a href="<%= profile.user.songs.song2 %>"><%= profile.user.songs.song2 %></a></li><% } %>
                    <% if(profile.user.songs.song3) { %><li><a href="<%= profile.user.songs.song3 %>"><%= profile.user.songs.song3 %></a></li><% } %>
                    <% if(profile.user.songs.song4) { %><li><a href="<%= profile.user.songs.song4 %>"><%= profile.user.songs.song4 %></a></li><% } %>
                    <% if(profile.user.songs.song5) { %><li><a href="<%= profile.user.songs.song5 %>"><%= profile.user.songs.song5 %></a></li><% } %>
                </ul>
            </section>
        <% } %>
    
        <% if(profile.user.books.book1) { %>
            <section>
                <h3>Books</h3>
                <ul>
                    <% if(profile.user.books.book1) { %><li><%= profile.user.books.book1 %></li><% } %>
                    <% if(profile.user.books.book2) { %><li><%= profile.user.books.book2 %></li><% } %>
                    <% if(profile.user.books.book3) { %><li><%= profile.user.books.book3 %></li><% } %>
                    <% if(profile.user.books.book4) { %><li><%= profile.user.books.book4 %></li><% } %>
                    <% if(profile.user.books.book5) { %><li><%= profile.user.books.book5 %></li><% } %>
                </ul>
            </section>
        <% } %>
    
        <% if(profile.user.links.link1) { %>
            <section>
                <h3>Links</h3>
                <ul>
                    <% if(profile.user.links.link1) { %><li><a href="<%= profile.user.links.link1 %>"><%= profile.user.links.link1 %></a></li><% } %>
                    <% if(profile.user.links.link2) { %><li><a href="<%= profile.user.links.link2 %>"><%= profile.user.links.link2 %></a></li><% } %>
                    <% if(profile.user.links.link3) { %><li><a href="<%= profile.user.links.link3 %>"><%= profile.user.links.link3 %></a></li><% } %>
                    <% if(profile.user.links.link4) { %><li><a href="<%= profile.user.links.link4 %>"><%= profile.user.links.link4 %></a></li><% } %>
                    <% if(profile.user.links.link5) { %><li><a href="<%= profile.user.links.link5 %>"><%= profile.user.links.link5 %></a></li><% } %>
                </ul>
            </section>
        <% } %>
    
        <!-- <img src="<%= profile.user.image %>" /> -->
    
        <% if(friends.length > 0) { %>
            <section id="friends-section">
                <h3><%= profile.username %> is a fan of</h3>
                <div id="friends">
                    <% friends.forEach(function(friend) { %>
                        <% if(friend != null) { %>
                            <a href="<%= friend.username %>" style="background-color: <%= friend.user.color %> !important;"><%= friend.username %></a>
                        <% } %>
                    <% }) %>
                </div>
            </section>
        <% } %>
    </div>
    
    
</main>

<script src="js/profile-tabs.js"></script>
<% include ../partials/footer %>